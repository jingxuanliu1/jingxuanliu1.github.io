<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Jingxuan Liu ‚Äî Portfolio</title>
  <meta name="description" content="Personal website and portfolio of Jingxuan Liu." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root { --bg:#0b0d10; --card:#12161b; --text:#e6eef8; --muted:#9fb2c8; --accent:#7aa2ff; }
    * { box-sizing: border-box; }
    body { margin:0; font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; color:var(--text); background:linear-gradient(120deg,#0b0d10,#0f1320 60%); }
    a { color:var(--accent); text-decoration:none; }
    a:hover { text-decoration:underline; }
    .wrap { max-width:1000px; margin:0 auto; padding:24px; position:relative; z-index:1; }
    header { display:flex; align-items:center; justify-content:space-between; gap:16px; padding:12px 0 8px; position:sticky; top:0; background:rgba(11,13,16,0.75); backdrop-filter: blur(8px); border-bottom:1px solid #1b2230; }
    nav a { margin:0 10px; font-weight:600; }
    .hero { padding:56px 0 24px; display:grid; grid-template-columns:1.2fr 1fr; gap:28px; align-items:center; }
    .hero h1 { margin:0 0 12px; font-size:44px; line-height:1.1; }
    .hero p { color:var(--muted); margin:0 0 20px; font-size:18px; }
    .btn { display:inline-block; padding:10px 16px; border-radius:10px; background:var(--accent); color:#0b0d10; font-weight:700; border:none; cursor:pointer; }
    .grid { display:grid; gap:16px; }
    @media (min-width:800px){ .grid-3{ grid-template-columns:repeat(3,1fr); } .grid-2{ grid-template-columns:repeat(2,1fr);} }
    .card { background:var(--card); border:1px solid #1b2230; border-radius:16px; padding:16px; box-shadow: 0 6px 20px rgba(0,0,0,.15); }
    .card h3 { margin:0 0 8px; }
    section { padding:28px 0; }
    footer { color:var(--muted); padding:28px 0 60px; text-align:center; border-top:1px solid #1b2230; margin-top:28px; }
    .tag { display:inline-block; font-size:12px; padding:4px 8px; border-radius:999px; background:#0b0d10; border:1px solid #1b2230; color:var(--muted); margin-right:6px; }
    img { width:100%; border-radius:12px; display:block; }

    /* Background starfield canvas */
    #stars{position:fixed; inset:0; z-index:0; pointer-events:none;}
    /* Lift site content above the canvas */
    .wrap{position:relative; z-index:1;}

    /* Chat widget styles */
    .chat-toggle{position:fixed; right:18px; bottom:18px; z-index:3; border:none; background:var(--accent); color:#0b0d10; font-weight:800; padding:12px 14px; border-radius:999px; box-shadow:0 10px 24px rgba(0,0,0,.35); cursor:pointer;}
    .chatbox{position:fixed; right:18px; bottom:76px; z-index:3; width:min(360px, calc(100vw - 36px)); background:var(--card); border:1px solid #1b2230; border-radius:16px; box-shadow:0 16px 40px rgba(0,0,0,.45); padding:14px;}
    .chatbox-header{display:flex; align-items:center; justify-content:space-between; margin-bottom:8px;}
    .chatbox-header button{background:transparent; border:1px solid #1b2230; color:var(--muted); border-radius:8px; padding:4px 8px; cursor:pointer;}
    #chat-form label{display:block; margin:8px 0;}
    #chat-form span{display:block; font-size:12px; color:var(--muted); margin-bottom:6px;}
    #chat-form input, #chat-form textarea{width:100%; padding:10px; border-radius:10px; border:1px solid #1b2230; background:#0b0d10; color:#e6eef8;}  
    .chat-actions{display:flex; align-items:center; gap:10px;}
    .chat-actions .hint{color:var(--muted);} 
    /* Toast */
    .toast{position:fixed; left:50%; bottom:24px; transform:translateX(-50%); background:#0b0d10; border:1px solid #1b2230; color:#e6eef8; padding:10px 14px; border-radius:12px; box-shadow:0 10px 24px rgba(0,0,0,.35); z-index:4;}

    /* ====== Scene (light-on + walking silhouette) ====== */
    .scene{ position:relative; overflow:hidden; }
    .scene img{ display:block; width:100%; border-radius:12px; filter:brightness(.65) contrast(1.02); transition:filter 900ms ease; }

    /* ‚ÄúLight turns on‚Äù overlay */
    .scene .light{
      position:absolute; inset:0; pointer-events:none; opacity:0; transition:opacity 900ms ease;
      background:
        radial-gradient(120% 120% at 60% 35%,
          rgba(255,255,220,.35) 0%,
          rgba(255,255,220,.15) 35%,
          rgba(0,0,0,.05) 60%,
          rgba(0,0,0,.25) 100%);
      mix-blend-mode:screen;
      border-radius:12px;
    }

    /* Walking silhouette */
    .walker{
      position:absolute; bottom:6%; left:-28%;
      width:20%; opacity:0;
      filter:drop-shadow(0 2px 2px rgba(0,0,0,.35));
      transform:translateX(0) translateY(0) scaleX(1);
    }
    .walker circle,.walker path{ fill:#0b0d10; }
    @media (prefers-color-scheme: dark){
      .walker circle,.walker path{ fill:#e6eef8; opacity:.9; }
    }

    /* Activated state */
    .scene-on img{ filter:brightness(1.05) contrast(1.05); }
    .scene-on .light{ opacity:1; }
    .scene-on .walker{
      opacity:1;
      animation:
        walker-x 5.2s ease-in-out forwards,
        walker-bob 750ms ease-in-out infinite;
    }

    /* Horizontal travel */
    @keyframes walker-x{
      0%   { transform:translateX(0) translateY(0) scaleX(1); }
      50%  { transform:translateX(80vw) translateY(0) scaleX(1); }
      55%  { transform:translateX(80vw) translateY(0) scaleX(-1); }
      100% { transform:translateX(15vw) translateY(0) scaleX(-1); }
    }

    /* Subtle bob */
    @keyframes walker-bob{
      0%,100% { transform:translateX(var(--walker-x,0)) translateY(0) scaleX(var(--walker-flip,1)); }
      50%     { transform:translateX(var(--walker-x,0)) translateY(-2px) scaleX(var(--walker-flip,1)); }
    }

    /* Respect reduced motion */
    @media (prefers-reduced-motion: reduce){
      .scene-on .walker{ animation:none; }
      .scene img{ transition:none; }
      .scene .light{ transition:none; }
    }

    /* ===== ML dropdown (new) ===== */
    .ml-menu{ position:relative; display:inline-block; margin-left:6px; }
    .ml-btn{ font-weight:700; padding:8px 10px; border-radius:8px; background:#182035; border:1px solid #273352; color:#c7d6f3; cursor:pointer; }
    .ml-menu-panel{
      position:absolute; right:0; top:110%;
      background:#12161b; border:1px solid #1b2230; border-radius:10px;
      padding:8px; min-width:240px; display:none;
      box-shadow:0 10px 28px rgba(0,0,0,.35); z-index:10;
    }
    .ml-item{ display:block; padding:8px 10px; color:#e6eef8; border-radius:8px; }
    .ml-item:hover{ background:#0f1423; text-decoration:none; }
  </style>
</head>
<body>
  <!-- Animated starfield background -->
  <canvas id="stars" aria-hidden="true"></canvas>

  <div class="wrap">
    <header>
      <div><a href="https://www.linkedin.com/in/jing-xuan-liu/" target="_blank" rel="noopener"><strong>Jingxuan Liu</strong></a></div>
      <nav>
        <a href="#projects">Projects</a>
        <a href="mailto:jingxuanliu317@gmail.com" aria-label="Email Jingxuan Liu">jingxuanliu317@gmail.com</a>
        <a href="/tasks.html" aria-label="Task dashboard">Tasks</a>

        <!-- ===== ML DROPDOWN (replaces single ML Viz link) ===== -->
        <div class="ml-menu">
          <button id="ml-btn" class="ml-btn" type="button" aria-haspopup="true" aria-expanded="false">ML ‚ñæ</button>
          <div id="ml-menu" class="ml-menu-panel" role="menu" aria-label="Machine Learning pages">
            <a href="/ml-viz.html" class="ml-item" role="menuitem">Clustering ‚Äî K-Means / GMM / DBSCAN</a>
            <a href="/ml-nn.html"  class="ml-item" role="menuitem">Neural Network ‚Äî Regression + ‚ÄúLottery‚Äù</a>
          </div>
        </div>
        <!-- ================================================ -->
      </nav>
    </header>

    <main>
      <section class="hero">
        <div>
          <h1>Hi, I‚Äôm Jingxuan Liu üëã</h1>
          <p>CS @ Georgia Tech ‚Ä¢ Interests: ML, Web, Systems. I build useful things with Java, Python, and C.</p>
          <p>
            <a class="btn" href="/resume.pdf" download target="_blank" rel="noopener">Download Resume</a>
            &nbsp;&nbsp;<a href="https://github.com/jingxuanliu1">GitHub</a> ¬∑
            <a href="https://www.linkedin.com/in/jing-xuan-liu/" target="_blank" rel="noopener" aria-label="Jingxuan Liu on LinkedIn">LinkedIn</a> ¬∑
            <a href="mailto:jingxuanliu317@gmail.com">Email</a>
          </p>
        </div>

        <!-- Hero preview with "light on" + walking silhouette -->
        <div class="card scene" id="hero-scene" aria-label="Preview scene with light turning on and a passerby silhouette">
          <img alt="Preview" src="https://picsum.photos/800/500" />
          <div class="light" aria-hidden="true"></div>

          <!-- Inline SVG silhouette -->
          <svg class="walker" viewBox="0 0 64 64" aria-hidden="true">
            <circle cx="33" cy="14" r="6" />
            <path d="M31 20 l-3 12 7 8 5 12 6-2 -4-13 4-7 3-7 -4-5 -6 3z" />
            <path d="M23 38 l8 4 4 10 -6 2 -9-10z" />
          </svg>
        </div>
      </section>

      <section id="projects">
        <h2>Projects</h2>
        <div class="grid grid-3">
          <article class="card">
            <h3>Time Map ‚Äî Task & Time Manager</h3>
            <p class="muted">Full-stack mobile website using Django/Python with user auth and MySQL.</p>
            <div>
              <span class="tag">Django</span><span class="tag">Python</span><span class="tag">MySQL</span>
            </div>
            <p><a href="https://github.com/jingxuanliu1">Code</a></p>
          </article>

          <article class="card">
            <h3>Movie Store ‚Äî Purchasing App</h3>
            <p>Cross-platform movie purchasing app with secure auth and payment processing.</p>
            <div>
              <span class="tag">Django</span><span class="tag">Python</span><span class="tag">MySQL</span>
            </div>
            <p><a href="https://github.com/jingxuanliu1">Code</a></p>
          </article>

          <article class="card">
            <h3>Interactive 2D Game</h3>
            <p>Built core mechanics and gameplay; tested for cross-platform compatibility.</p>
            <div>
              <span class="tag">C</span><span class="tag">Unity</span>
            </div>
            <p><a href="https://github.com/jingxuanliu1">Code</a></p>
          </article>

          <article class="card">
            <h3>Autonomous Robotic System</h3>
            <p>Programmed control algorithms and validated performance across conditions.</p>
            <div>
              <span class="tag">Python</span><span class="tag">Robotics</span>
            </div>
            <p><a href="https://github.com/jingxuanliu1">Code</a></p>
          </article>
        </div>
      </section>
    </main>

    <!-- Floating chat/comment widget -->
    <button id="chat-toggle" aria-controls="chatbox" aria-expanded="false" class="chat-toggle" title="Open comments">üí¨</button>
    <div id="chatbox" class="chatbox" hidden>
      <div class="chatbox-header">
        <strong>Leave a comment</strong>
        <button id="chat-close" aria-label="Close">‚úï</button>
      </div>
      <form id="chat-form" novalidate>
        <label>
          <span>Name</span>
          <input type="text" id="c-name" name="name" placeholder="Your name" required>
        </label>
        <label>
          <span>Email (optional)</span>
          <input type="email" id="c-email" name="email" placeholder="you@email.com">
        </label>
        <label>
          <span>Message</span>
          <textarea id="c-msg" name="message" rows="4" placeholder="Say hi or leave feedback‚Ä¶" required></textarea>
        </label>
        <div class="chat-actions">
          <button type="submit" class="btn">Send</button>
          <small class="hint">Sends to the site owner (no login needed)</small>
        </div>
      </form>
    </div>

    <footer>
      ¬© <span id="year"></span> Jingxuan Liu ¬∑ Built with HTML/CSS ¬∑ Hosted on GitHub Pages
    </footer>
  </div>

  <script>
/* Footer year */
document.getElementById('year').textContent = new Date().getFullYear();

/* Sprite-glow starfield with adaptive quality (fast + pretty) */
(function(){
  const canvas = document.getElementById('stars');
  const ctx = canvas.getContext('2d');
  let cssW, cssH, dpr, stars = [];

  // Mouse tracking for constellation effect
  const mouse = { x: null, y: null, active: false };
  window.addEventListener('pointermove', (e)=>{
    const rect = canvas.getBoundingClientRect();
    mouse.x = e.clientX - rect.left;
    mouse.y = e.clientY - rect.top;
    mouse.active = true;
  }, { passive:true });
  window.addEventListener('pointerleave', ()=>{ mouse.active = false; }, { passive:true });

  // Respect reduced motion
  const reduceMotion = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;

  // ---- Adaptive quality (auto-tunes DPR, density, line limits) ----
  let quality = reduceMotion ? 1 : 3; // 3=high, 2=med, 1=low

  function currentTunables(){
    if (quality === 3) return { MAX_DPR:1.5, DENSITY:0.18, LINES:700, GRID_N:2 };
    if (quality === 2) return { MAX_DPR:1.35, DENSITY:0.14, LINES:450, GRID_N:3 };
    return               { MAX_DPR:1.2, DENSITY:0.10, LINES:300, GRID_N:4 };
  }

  let fpsSamples = [];
  let lastFPSDropAt = 0;
  function trackFPS(dt){
    const fps = 1 / Math.max(0.0001, dt);
    fpsSamples.push(fps);
    if (fpsSamples.length > 30) fpsSamples.shift(); // ~0.5s window @60fps
    const avg = fpsSamples.reduce((a,b)=>a+b,0) / fpsSamples.length;
    const now = performance.now();
    if (avg < 48 && quality > 1 && now - lastFPSDropAt > 2000){
      quality--;
      lastFPSDropAt = now;
      applyTunablesAndResize();
    }
  }

  // Tunables (updated by quality)
  let MAX_DPR = 1.5, STAR_DENSITY = 0.18, MAX_LINES_PER_FRAME = 700, GRID_REBUILD_EVERY_N = 2;

  function applyTunablesAndResize(){
    const t = currentTunables();
    MAX_DPR = t.MAX_DPR;
    STAR_DENSITY = t.DENSITY;
    MAX_LINES_PER_FRAME = t.LINES;
    GRID_REBUILD_EVERY_N = t.GRID_N;
    resize();
  }

  // Animation speed (slower if reduced motion)
  const SPEED_SCALE = reduceMotion ? 0.25 : 1.0;

  // Constellation parameters
  const MAX_DIST = 130;     // max distance to draw a line (CSS px)
  const MOUSE_RADIUS = 180; // lines appear when stars are near the cursor

  // Pre-rendered glow sprite
  let glowSprite = null;
  function makeGlowSprite(){
    const size = 64;
    const c = document.createElement('canvas');
    c.width = c.height = size;
    const g = c.getContext('2d');

    const grad = g.createRadialGradient(size/2, size/2, 0, size/2, size/2, size/2);
    grad.addColorStop(0.0, 'rgba(255,255,255,0.95)');
    grad.addColorStop(0.25, 'rgba(255,255,255,0.60)');
    grad.addColorStop(0.55, 'rgba(122,162,255,0.35)');
    grad.addColorStop(1.0, 'rgba(122,162,255,0.00)');
    g.fillStyle = grad;
    g.fillRect(0,0,size,size);
    return c;
  }

  function resize(){
    dpr = Math.max(1, Math.min(MAX_DPR, window.devicePixelRatio || 1));
    cssW = window.innerWidth; cssH = window.innerHeight;
    canvas.width = Math.floor(cssW * dpr);
    canvas.height = Math.floor(cssH * dpr);
    canvas.style.width = cssW + 'px';
    canvas.style.height = cssH + 'px';
    ctx.setTransform(dpr,0,0,dpr,0,0);

    const small = cssW * cssH < 800 * 800;
    const density = reduceMotion ? Math.min(0.10, STAR_DENSITY) : (small ? Math.max(0.10, STAR_DENSITY * 0.8) : STAR_DENSITY);
    const target = Math.max(90, Math.floor((cssW * cssH / 1000000) * density * 1100));
    stars = new Array(target).fill(0).map(()=>newStar(true));

    if (!glowSprite) glowSprite = makeGlowSprite();
  }

  function newStar(initial=false){
    const r = Math.random()*1.6 + 0.6;
    const speed = (Math.random()*0.9 + 0.35) * (cssH/900) * SPEED_SCALE;
    const drift = (Math.random()*0.3 - 0.15) * SPEED_SCALE;
    const tw = Math.random()*0.9 + 0.3;
    return {
      x: Math.random()*cssW,
      y: initial ? Math.random()*cssH : -10,
      r, speed, drift,
      baseA: Math.random()*0.6 + 0.35,
      t: Math.random()*Math.PI*2,
      tw,
    };
  }

  function step(dt){
    for (let s of stars){
      s.y += s.speed * dt * 60;
      s.x += s.drift * dt * 60;
      s.t += (s.tw * dt);
      if (s.y - s.r > cssH) { s.y = -s.r; s.x = Math.random()*cssW; }
      if (s.x < -5) s.x = cssW + 5; else if (s.x > cssW + 5) s.x = -5;
    }
  }

  // Spatial grid cache for constellation lines
  let cachedGrid = null;
  let frameCount = 0;
  function buildGrid(cell){
    const grid = new Map();
    for (let i=0;i<stars.length;i++){
      const s = stars[i];
      const gx = Math.floor(s.x / cell);
      const gy = Math.floor(s.y / cell);
      const key = gx+','+gy;
      if (!grid.has(key)) grid.set(key, []);
      grid.get(key).push(i);
    }
    return grid;
  }

  function draw(){
    ctx.clearRect(0,0,cssW,cssH);

    // 1) Draw stars
    ctx.save();
    ctx.globalCompositeOperation = 'lighter';
    for (let s of stars){
      const twinkle = 0.6 + 0.4 * Math.sin(s.t);
      const a = Math.max(0.12, Math.min(1, s.baseA * twinkle));
      const haloScale = 2.6;
      const w = s.r * haloScale * 8;
      const h = w;
      ctx.globalAlpha = a;
      ctx.drawImage(glowSprite, s.x - w/2, s.y - h/2, w, h);
    }
    ctx.restore();

    // 2) Constellation lines near mouse (throttled)
    if (mouse.active){
      const cell = 130;

      if (frameCount % 2 === 0 || !cachedGrid){
        cachedGrid = buildGrid(cell);
      }
      const grid = cachedGrid;

      ctx.save();
      ctx.globalCompositeOperation = 'lighter';

      let linesDrawn = 0;

      outer: for (let i=0;i<stars.length;i++){
        const s = stars[i];
        const dm1 = Math.hypot(mouse.x - s.x, mouse.y - s.y);
        if (dm1 > 180) continue;

        const gx = Math.floor(s.x / cell), gy = Math.floor(s.y / cell);
        for (let oy=-1; oy<=1; oy++){
          for (let ox=-1; ox<=1; ox++){
            const key = (gx+ox)+','+(gy+oy);
            const bucket = grid.get(key);
            if (!bucket) continue;
            for (const j of bucket){
              if (j <= i) continue;
              const t = stars[j];
              const dm2 = Math.hypot(mouse.x - t.x, mouse.y - t.y);
              const dx = t.x - s.x, dy = t.y - s.y;
              const d = Math.hypot(dx, dy);
              if (d < 130 && dm2 < 180){
                const nearMouse = 1 - Math.min(Math.min(dm1, dm2) / 180, 1);
                const nearEachOther = 1 - (d / 130);
                const alpha = Math.max(0, Math.min(1, 0.9 * nearMouse * nearEachOther));

                if (++linesDrawn > 700) { break outer; }

                ctx.globalAlpha = alpha * 0.9;
                ctx.lineWidth = 1.0 + 0.6 * (nearMouse * nearEachOther);
                ctx.strokeStyle = '#7aa2ff';
                ctx.beginPath();
                ctx.moveTo(s.x, s.y);
                ctx.lineTo(t.x, t.y);
                ctx.stroke();
              }
            }
          }
        }
      }
      ctx.restore();
    }
  }

  // Main loop
  let last = performance.now();
  function loop(now){
    const dt = Math.min(0.05, (now - last)/1000);
    last = now;
    frameCount++;
    trackFPS(dt);
    step(dt);
    draw();
    requestAnimationFrame(loop);
  }

  window.addEventListener('resize', applyTunablesAndResize, { passive:true });
  applyTunablesAndResize();
  requestAnimationFrame(loop);
})();

/* Turn on the scene light after ~3s, then let the walker animate */
(function(){
  const scene = document.getElementById('hero-scene');
  const reduceMotion = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
  if (!scene) return;
  setTimeout(()=>{ 
    scene.classList.add('scene-on');
  }, reduceMotion ? 0 : 3000);
})();

/* Chat widget logic: submit via Form endpoint if configured, else mailto fallback */
(function(){
  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  // Set this to your Formspree/Getform endpoint to send directly to your email.
  // Example: const FORM_ENDPOINT = "https://formspree.io/f/abcdwxyz";
  const FORM_ENDPOINT = ""; // <-- PUT YOUR ENDPOINT HERE (leave empty to use mailto fallback)
  const DEST_EMAIL = "jingxuanliu317@gmail.com"; // used for mailto fallback
  // <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

  const toggle = document.getElementById('chat-toggle');
  const box = document.getElementById('chatbox');
  const closeBtn = document.getElementById('chat-close');
  const form = document.getElementById('chat-form');

  // Honeypot field (to reduce spam)
  const honeypot = document.createElement('input');
  honeypot.type = 'text';
  honeypot.name = 'company';
  honeypot.autocomplete = 'off';
  honeypot.style.display = 'none';
  form.appendChild(honeypot);

  function toast(msg){
    const t = document.createElement('div');
    t.className = 'toast';
    t.textContent = msg;
    document.body.appendChild(t);
    setTimeout(()=>{ t.remove(); }, 2600);
  }

  function open(){ box.hidden=false; toggle.setAttribute('aria-expanded','true'); }
  function close(){ box.hidden=true; toggle.setAttribute('aria-expanded','false'); }

  toggle.addEventListener('click', ()=> box.hidden ? open() : close());
  closeBtn.addEventListener('click', close);

  form.addEventListener('submit', async (e)=>{
    e.preventDefault();
    const name = (document.getElementById('c-name').value||'').trim();
    let email = (document.getElementById('c-email').value||'').trim();
    const msg = (document.getElementById('c-msg').value||'').trim();
    if (!name || !msg){ toast('Please include your name and a message.'); return; }
    if (honeypot.value){ return; } // bot

    if (!email) email = 'Anonymous';

    // If a Form endpoint is configured, post directly (no mail client needed)
    if (FORM_ENDPOINT){
      try{
        const res = await fetch(FORM_ENDPOINT, {
          method:'POST',
          headers:{ 'Content-Type':'application/json', 'Accept':'application/json' },
          body: JSON.stringify({ name, email, message: msg, _subject: `Portfolio message from ${name}` })
        });
        if (!res.ok) throw new Error('Network response was not ok');
        toast('Message sent ‚úî');
        form.reset();
        close();
      }catch(err){
        console.error(err);
        toast('Send failed. Using email instead‚Ä¶');
        // fallback to mailto
        const subject = encodeURIComponent('Portfolio message from ' + name);
        const body = encodeURIComponent(`From: ${name} <${email}>\n\n${msg}\n\n‚Äî Sent from jingxuanliu.com`);
        window.location.href = `mailto:${DEST_EMAIL}?subject=${subject}&body=${body}`;
        close();
      }
    } else {
      // No endpoint set ‚Üí open mail client (previous behavior)
      const subject = encodeURIComponent('Portfolio message from ' + name);
      const body = encodeURIComponent(`From: ${name} <${email}>\n\n${msg}\n\n‚Äî Sent from jingxuanliu.com`);
      window.location.href = `mailto:${DEST_EMAIL}?subject=${subject}&body=${body}`;
      close();
    }
  });
})();

/* ===== ML dropdown behavior ===== */
(function(){
  const btn  = document.getElementById('ml-btn');
  const menu = document.getElementById('ml-menu');
  if(!btn || !menu) return;

  function toggle(show){
    menu.style.display = show ? 'block' : 'none';
    btn.setAttribute('aria-expanded', show ? 'true' : 'false');
  }

  btn.addEventListener('click', (e)=>{
    e.stopPropagation();
    toggle(menu.style.display !== 'block');
  });

  // close on outside click
  document.addEventListener('click', (e)=>{
    if(!menu.contains(e.target) && e.target !== btn) toggle(false);
  });
  // close on Escape
  document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape') toggle(false); });
})();
  </script>
</body>
</html>
